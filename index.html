<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solar System Viewer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(to bottom, #0a0e27 0%, #1a1a2e 50%, #16213e 100%);
            min-height: 100vh;
            color: #333;
            position: relative;
            overflow-x: hidden;
        }

        body.fullscreen-mode {
            overflow: hidden;
        }

        /* Animated starry background */
        .stars-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle linear infinite, moveStar linear infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.2; }
            50% { opacity: 1; }
        }

        @keyframes moveStar {
            0% { transform: translate(0, 0); }
            100% { transform: translate(-100px, 100px); }
        }

        /* Navigation */
        nav {
            background: rgba(30, 58, 138, 0.85);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 20px rgba(0,0,0,0.3);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        body.fullscreen-mode nav {
            display: none;
        }
        
        .nav-container {
            max-width: 1800px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }
        
        .logo {
            color: white;
            font-size: 24px;
            font-weight: bold;
            padding: 15px 0;
        }
        
        .nav-menu {
            display: flex;
            list-style: none;
            gap: 0;
        }
        
        .nav-menu li a {
            color: white;
            text-decoration: none;
            padding: 20px 25px;
            display: block;
            transition: background 0.3s;
        }
        
        .nav-menu li a:hover {
            background: rgba(255,255,255,0.1);
        }
        
        .hamburger {
            display: none;
            flex-direction: column;
            cursor: pointer;
            padding: 10px;
        }
        
        .hamburger span {
            width: 25px;
            height: 3px;
            background: white;
            margin: 3px 0;
            transition: 0.3s;
        }

        /* Main Container */
        .page-wrapper {
            max-width: 1800px;
            margin: 0 auto;
            padding: 30px 20px;
            position: relative;
            z-index: 1;
        }

        body.fullscreen-mode .page-wrapper {
            padding: 0;
            max-width: 100%;
            margin: 0;
        }

        /* Canvas Container - Full Width */
        .canvas-wrapper {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            border: 3px solid #3b82f6;
            backdrop-filter: blur(10px);
            margin-bottom: 30px;
            position: relative;
        }

        body.fullscreen-mode .canvas-wrapper {
            border-radius: 0;
            border: none;
            margin-bottom: 0;
            box-shadow: none;
        }
        
        #container {
            width: 100%;
            height: 900px;
            position: relative;
            background: #000000;
        }

        body.fullscreen-mode #container {
            height: 100vh;
            width: 100vw;
        }

        #container.dark-canvas {
            background: #1a1a1a;
        }
        
        canvas {
            display: block;
            width: 100%;
            height: 100%;
        }

        /* Canvas Background Toggle */
        .canvas-bg-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 10;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 12px 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .toggle-row {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .canvas-bg-label {
            color: white;
            font-weight: 600;
            font-size: 13px;
            min-width: 85px;
        }

        #container.dark-canvas .canvas-bg-label {
            color: white;
        }

        /* Layers Panel - Inside Canvas */
        .layers-panel {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 10;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            width: 220px;
            max-height: 800px;
            overflow-y: auto;
        }

        #container.dark-canvas .layers-panel {
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.15);
        }
        
        .layers-panel h3 {
            color: #93c5fd;
            margin-bottom: 15px;
            font-size: 18px;
            border-bottom: 2px solid #3b82f6;
            padding-bottom: 8px;
        }

        #container.dark-canvas .layers-panel h3 {
            color: #93c5fd;
        }
        
        .layer-item {
            margin-bottom: 5px;
        }

        .layer-header {
            display: flex;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(229, 231, 235, 0.3);
            cursor: pointer;
            user-select: none;
        }

        .expand-btn {
            width: 20px;
            height: 20px;
            margin-right: 8px;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 3px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .expand-btn:hover {
            background: #2563eb;
        }
        
        .toggle-switch {
            position: relative;
            width: 50px;
            height: 24px;
            margin-right: 12px;
            flex-shrink: 0;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(203, 213, 225, 0.5);
            transition: .4s;
            border-radius: 24px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: #3b82f6;
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        .layer-label {
            font-size: 14px;
            color: #e5e7eb;
            font-weight: 500;
        }

        #container.dark-canvas .layer-label {
            color: #e5e7eb;
        }

        .sub-layers {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            padding-left: 28px;
        }

        .sub-layers.expanded {
            max-height: 500px;
        }

        .sub-layer-item {
            display: flex;
            align-items: center;
            padding: 8px 0;
            padding-left: 10px;
            border-left: 2px solid rgba(229, 231, 235, 0.3);
        }

        .sub-layer-item .toggle-switch {
            width: 40px;
            height: 20px;
            margin-right: 10px;
        }

        .sub-layer-item .slider:before {
            height: 14px;
            width: 14px;
        }

        .sub-layer-item input:checked + .slider:before {
            transform: translateX(20px);
        }

        .sub-layer-item .layer-label {
            font-size: 13px;
            color: #cbd5e1;
            font-weight: 400;
        }

        #container.dark-canvas .sub-layer-item .layer-label {
            color: #cbd5e1;
        }

        /* View Controls Overlay - Right Bottom with Glassmorphism */
        #controls {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #e0e7ff;
            padding: 15px;
            border-radius: 12px;
            font-size: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            max-width: 240px;
            pointer-events: none;
        }

        #container.dark-canvas #controls {
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.15);
        }
        
        #controls h4 {
            margin: 0 0 8px 0;
            color: #93c5fd;
            font-size: 14px;
            font-weight: bold;
        }

        #container.dark-canvas #controls h4 {
            color: #93c5fd;
        }
        
        .control-item {
            margin: 5px 0;
            font-size: 11px;
            line-height: 1.4;
        }
        
        .control-label {
            font-weight: bold;
            color: #e0e7ff;
            display: inline-block;
            min-width: 75px;
        }

        #container.dark-canvas .control-label {
            color: #e0e7ff;
        }

        #container.dark-canvas .control-item {
            color: #cbd5e1;
        }

        /* Scrollbar for layers panel */
        .layers-panel::-webkit-scrollbar {
            width: 6px;
        }

        .layers-panel::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.1);
            border-radius: 10px;
        }

        .layers-panel::-webkit-scrollbar-thumb {
            background: rgba(59, 130, 246, 0.5);
            border-radius: 10px;
        }

        .layers-panel::-webkit-scrollbar-thumb:hover {
            background: rgba(59, 130, 246, 0.7);
        }

        /* About Section */
        .about-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
        }

        body.fullscreen-mode .about-section {
            display: none;
        }
        
        .about-section h3 {
            color: #1e3a8a;
            margin-bottom: 20px;
            font-size: 24px;
            border-bottom: 3px solid #3b82f6;
            padding-bottom: 12px;
        }
        
        .about-section p {
            color: #475569;
            line-height: 1.8;
            font-size: 15px;
            margin-bottom: 25px;
        }

        .project-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            border-radius: 8px;
            color: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .stat-label {
            font-size: 13px;
            opacity: 0.9;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
        }

        /* Footer */
        footer {
            background: rgba(30, 58, 138, 0.85);
            backdrop-filter: blur(10px);
            color: white;
            padding: 40px 20px 20px;
            margin-top: 50px;
            box-shadow: 0 -2px 20px rgba(0,0,0,0.3);
        }

        body.fullscreen-mode footer {
            display: none;
        }
        
        .footer-content {
            max-width: 1800px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .footer-section h4 {
            color: #93c5fd;
            margin-bottom: 15px;
            font-size: 16px;
        }
        
        .footer-section ul {
            list-style: none;
        }
        
        .footer-section ul li {
            margin: 8px 0;
        }
        
        .footer-section a {
            color: #e0e7ff;
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .footer-section a:hover {
            color: #93c5fd;
        }
        
        .footer-bottom {
            max-width: 1800px;
            margin: 0 auto;
            padding-top: 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
            text-align: center;
            color: #93c5fd;
            font-size: 14px;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            #container {
                height: 800px;
            }

            .project-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .layers-panel {
                width: 200px;
            }
        }
        
        @media (max-width: 768px) {
            .nav-menu {
                position: fixed;
                left: -100%;
                top: 60px;
                flex-direction: column;
                background: rgba(30, 58, 138, 0.95);
                width: 100%;
                text-align: center;
                transition: 0.3s;
                box-shadow: 0 10px 27px rgba(0,0,0,0.05);
            }
            
            .nav-menu.active {
                left: 0;
            }
            
            .nav-menu li {
                margin: 0;
            }
            
            .hamburger {
                display: flex;
            }
            
            #container {
                height: 600px;
            }
            
            .footer-content {
                grid-template-columns: 1fr;
                text-align: center;
            }

            .project-stats {
                grid-template-columns: 1fr;
            }

            .layers-panel {
                width: 180px;
                max-height: 500px;
            }

            .canvas-bg-toggle {
                top: 15px;
                right: 15px;
                padding: 10px 16px;
            }

            #controls {
                max-width: 200px;
                padding: 12px;
            }
        }
        
        @media (max-width: 480px) {
            .page-wrapper {
                padding: 15px 10px;
            }
            
            .about-section {
                padding: 15px;
            }
            
            #container {
                height: 500px;
            }
            
            #controls {
                font-size: 10px;
                padding: 10px;
                max-width: 180px;
            }
            
            .control-label {
                min-width: 60px;
            }

            .layers-panel {
                width: 160px;
                padding: 15px;
                max-height: 400px;
            }

            .layers-panel h3 {
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <!-- Starry background -->
    <div class="stars-container" id="starsContainer"></div>

    <!-- Navigation -->
    <nav>
        <div class="nav-container">
            <div class="logo">Solar System Explorer</div>
            <ul class="nav-menu" id="navMenu">
                <li><a href="#home">Home</a></li>
                <li><a href="#projects">Projects</a></li>
                <li><a href="#analysis">Analysis</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
            <div class="hamburger" id="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="page-wrapper">
        <!-- Canvas with Layers Inside -->
        <div class="canvas-wrapper">
            <div id="container">
                <!-- Canvas Background Toggle -->
                <div class="canvas-bg-toggle">
                    <div class="toggle-row">
                        <span class="canvas-bg-label">Canvas BG</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="canvasBgToggle" onchange="toggleCanvasBackground()">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="toggle-row">
                        <span class="canvas-bg-label">Fullscreen</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="fullscreenToggle" onchange="toggleFullscreen()">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="toggle-row">
                        <span class="canvas-bg-label">Asteroids</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="asteroidsToggle" checked onchange="toggleAsteroids(this.checked)">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="toggle-row">
                        <span class="canvas-bg-label">Comets</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="cometsToggle" checked onchange="toggleComets(this.checked)">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="toggle-row">
                        <span class="canvas-bg-label">Galaxy</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="galaxyToggle" checked onchange="toggleGalaxy(this.checked)">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>

                <!-- Layers Panel Inside Canvas -->
                <div class="layers-panel">
                    <h3>Celestial Bodies</h3>
                    
                    <!-- Sun -->
                    <div class="layer-item">
                        <div class="layer-header" onclick="toggleSubLayers(this)">
                            <button class="expand-btn">+</button>
                            <label class="toggle-switch">
                                <input type="checkbox" checked onchange="toggleSun(this.checked)">
                                <span class="slider"></span>
                            </label>
                            <span class="layer-label">Sun</span>
                        </div>
                        <div class="sub-layers">
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="toggleSun(this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Solar Core</span>
                            </div>
                        </div>
                    </div>

                    <!-- Mercury -->
                    <div class="layer-item">
                        <div class="layer-header" onclick="toggleSubLayers(this)">
                            <button class="expand-btn">+</button>
                            <label class="toggle-switch">
                                <input type="checkbox" checked onchange="togglePlanet('mercury', this.checked)">
                                <span class="slider"></span>
                            </label>
                            <span class="layer-label">Mercury</span>
                        </div>
                        <div class="sub-layers">
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="togglePlanetOrbit('mercury', this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Orbit Path</span>
                            </div>
                        </div>
                    </div>

                    <!-- Venus -->
                    <div class="layer-item">
                        <div class="layer-header" onclick="toggleSubLayers(this)">
                            <button class="expand-btn">+</button>
                            <label class="toggle-switch">
                                <input type="checkbox" checked onchange="togglePlanet('venus', this.checked)">
                                <span class="slider"></span>
                            </label>
                            <span class="layer-label">Venus</span>
                        </div>
                        <div class="sub-layers">
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="togglePlanetOrbit('venus', this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Orbit Path</span>
                            </div>
                        </div>
                    </div>

                    <!-- Earth -->
                    <div class="layer-item">
                        <div class="layer-header" onclick="toggleSubLayers(this)">
                            <button class="expand-btn">+</button>
                            <label class="toggle-switch">
                                <input type="checkbox" checked onchange="togglePlanet('earth', this.checked)">
                                <span class="slider"></span>
                            </label>
                            <span class="layer-label">Earth</span>
                        </div>
                        <div class="sub-layers">
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="toggleMoon('earth', 0, this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Moon</span>
                            </div>
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="togglePlanetOrbit('earth', this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Orbit Path</span>
                            </div>
                        </div>
                    </div>

                    <!-- Mars -->
                    <div class="layer-item">
                        <div class="layer-header" onclick="toggleSubLayers(this)">
                            <button class="expand-btn">+</button>
                            <label class="toggle-switch">
                                <input type="checkbox" checked onchange="togglePlanet('mars', this.checked)">
                                <span class="slider"></span>
                            </label>
                            <span class="layer-label">Mars</span>
                        </div>
                        <div class="sub-layers">
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="toggleMoon('mars', 0, this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Phobos</span>
                            </div>
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="toggleMoon('mars', 1, this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Deimos</span>
                            </div>
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="togglePlanetOrbit('mars', this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Orbit Path</span>
                            </div>
                        </div>
                    </div>

                    <!-- Jupiter -->
                    <div class="layer-item">
                        <div class="layer-header" onclick="toggleSubLayers(this)">
                            <button class="expand-btn">+</button>
                            <label class="toggle-switch">
                                <input type="checkbox" checked onchange="togglePlanet('jupiter', this.checked)">
                                <span class="slider"></span>
                            </label>
                            <span class="layer-label">Jupiter</span>
                        </div>
                        <div class="sub-layers">
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="toggleMoon('jupiter', 0, this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Io</span>
                            </div>
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="toggleMoon('jupiter', 1, this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Europa</span>
                            </div>
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="toggleMoon('jupiter', 2, this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Ganymede</span>
                            </div>
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="toggleMoon('jupiter', 3, this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Callisto</span>
                            </div>
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="togglePlanetOrbit('jupiter', this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Orbit Path</span>
                            </div>
                        </div>
                    </div>

                    <!-- Saturn -->
                    <div class="layer-item">
                        <div class="layer-header" onclick="toggleSubLayers(this)">
                            <button class="expand-btn">+</button>
                            <label class="toggle-switch">
                                <input type="checkbox" checked onchange="togglePlanet('saturn', this.checked)">
                                <span class="slider"></span>
                            </label>
                            <span class="layer-label">Saturn</span>
                        </div>
                        <div class="sub-layers">
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="toggleMoon('saturn', 0, this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Titan</span>
                            </div>
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="toggleMoon('saturn', 1, this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Rhea</span>
                            </div>
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="toggleMoon('saturn', 2, this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Iapetus</span>
                            </div>
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="toggleRings('saturn', this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Rings</span>
                            </div>
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="togglePlanetOrbit('saturn', this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Orbit Path</span>
                            </div>
                        </div>
                    </div>

                    <!-- Uranus -->
                    <div class="layer-item">
                        <div class="layer-header" onclick="toggleSubLayers(this)">
                            <button class="expand-btn">+</button>
                            <label class="toggle-switch">
                                <input type="checkbox" checked onchange="togglePlanet('uranus', this.checked)">
                                <span class="slider"></span>
                            </label>
                            <span class="layer-label">Uranus</span>
                        </div>
                        <div class="sub-layers">
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="toggleMoon('uranus', 0, this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Titania</span>
                            </div>
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="toggleMoon('uranus', 1, this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Oberon</span>
                            </div>
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="toggleMoon('uranus', 2, this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Umbriel</span>
                            </div>
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="toggleMoon('uranus', 3, this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Ariel</span>
                            </div>
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="toggleRings('uranus', this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Rings</span>
                            </div>
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="togglePlanetOrbit('uranus', this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Orbit Path</span>
                            </div>
                        </div>
                    </div>

                    <!-- Neptune -->
                    <div class="layer-item">
                        <div class="layer-header" onclick="toggleSubLayers(this)">
                            <button class="expand-btn">+</button>
                            <label class="toggle-switch">
                                <input type="checkbox" checked onchange="togglePlanet('neptune', this.checked)">
                                <span class="slider"></span>
                            </label>
                            <span class="layer-label">Neptune</span>
                        </div>
                        <div class="sub-layers">
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="toggleMoon('neptune', 0, this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Triton</span>
                            </div>
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="toggleMoon('neptune', 1, this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Proteus</span>
                            </div>
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="toggleRings('neptune', this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Rings</span>
                            </div>
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="togglePlanetOrbit('neptune', this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Orbit Path</span>
                            </div>
                        </div>
                    </div>

                    <!-- Effects -->
                    <div class="layer-item">
                        <div class="layer-header" onclick="toggleSubLayers(this)">
                            <button class="expand-btn">+</button>
                            <label class="toggle-switch">
                                <input type="checkbox" checked>
                                <span class="slider"></span>
                            </label>
                            <span class="layer-label">Effects</span>
                        </div>
                        <div class="sub-layers">
                            <div class="sub-layer-item">
                                <label class="toggle-switch">
                                    <input type="checkbox" checked onchange="toggleStars(this.checked)">
                                    <span class="slider"></span>
                                </label>
                                <span class="layer-label">Star Field</span>
                            </div>
                        </div>
                    </div>
                </div>

                <canvas id="canvas"></canvas>
                
                <!-- View Controls -->
                <div id="controls">
                    <h4>View Controls</h4>
                    <div class="control-item">
                        <span class="control-label">Rotate:</span> Left Click + Drag
                    </div>
                    <div class="control-item">
                        <span class="control-label">Pan:</span> Right Click + Drag
                    </div>
                    <div class="control-item">
                        <span class="control-label">Zoom:</span> Mouse Scroll
                    </div>
                    <div class="control-item">
                        <span class="control-label">Navigate:</span> Arrow Keys
                    </div>
                    <div class="control-item">
                        <span class="control-label">Vertical:</span> Space / Shift
                    </div>
                </div>
            </div>
        </div>

        <!-- About Section with Stats -->
        <div class="about-section">
            <h3>About Our Solar System</h3>
            <p>Explore our magnificent solar system with this interactive 3D visualization. Watch as eight planets orbit around our Sun, each with their unique characteristics and orbital paths. This real-time simulation demonstrates planetary motion, relative sizes, and the vast distances that separate these celestial bodies. The visualization combines accurate astronomical data with stunning visual effects to create an immersive educational experience.</p>
            
            <div class="project-stats">
                <div class="stat-card">
                    <div class="stat-label">Star</div>
                    <div class="stat-value">1 Sun</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Planets</div>
                    <div class="stat-value">8 Worlds</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Largest Planet</div>
                    <div class="stat-value">Jupiter</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Smallest Planet</div>
                    <div class="stat-value">Mercury</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Habitable Zone</div>
                    <div class="stat-value">Earth</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Age</div>
                    <div class="stat-value">4.6B Years</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h4>Company</h4>
                <ul>
                    <li><a href="#about">About Us</a></li>
                    <li><a href="#team">Our Team</a></li>
                    <li><a href="#careers">Careers</a></li>
                    <li><a href="#press">Press</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Services</h4>
                <ul>
                    <li><a href="#optimization">Space Education</a></li>
                    <li><a href="#analysis">3D Visualization</a></li>
                    <li><a href="#consulting">Consulting</a></li>
                    <li><a href="#training">Training</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Resources</h4>
                <ul>
                    <li><a href="#docs">Documentation</a></li>
                    <li><a href="#api">API</a></li>
                    <li><a href="#support">Support</a></li>
                    <li><a href="#faq">FAQ</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Contact</h4>
                <ul>
                    <li><a href="mailto:info@solarexplorer.com">info@solarexplorer.com</a></li>
                    <li><a href="tel:+1234567890">+1 (234) 567-890</a></li>
                    <li>123 Astronomy Lane</li>
                    <li>San Francisco, CA 94105</li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 Solar System Explorer. All rights reserved. | <a href="#privacy">Privacy Policy</a> | <a href="#terms">Terms of Service</a></p>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        // Fullscreen Toggle Function
        function toggleFullscreen() {
            const body = document.body;
            const toggle = document.getElementById('fullscreenToggle');
            
            if (toggle.checked) {
                body.classList.add('fullscreen-mode');
            } else {
                body.classList.remove('fullscreen-mode');
            }
            
            setTimeout(() => {
                onWindowResize();
            }, 100);
        }

        // Canvas Background Toggle Function
        function toggleCanvasBackground() {
            const container = document.getElementById('container');
            const toggle = document.getElementById('canvasBgToggle');
            
            if (toggle.checked) {
                container.classList.add('dark-canvas');
                scene.background = new THREE.Color(0x1a1a1a);
            } else {
                container.classList.remove('dark-canvas');
                scene.background = new THREE.Color(0x000000);
            }
        }

        // Create animated moving stars background
        function createStars() {
            const container = document.getElementById('starsContainer');
            const numStars = 200;
            
            for (let i = 0; i < numStars; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                
                const size = Math.random() * 3 + 1;
                star.style.width = size + 'px';
                star.style.height = size + 'px';
                
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                
                const twinkleDuration = Math.random() * 4 + 2;
                const moveDuration = Math.random() * 40 + 40;
                
                star.style.animation = `twinkle ${twinkleDuration}s linear infinite, moveStar ${moveDuration}s linear infinite`;
                
                container.appendChild(star);
            }
        }

        createStars();

        // Layer expansion toggle
        function toggleSubLayers(header) {
            const subLayers = header.nextElementSibling;
            const expandBtn = header.querySelector('.expand-btn');
            
            if (subLayers.classList.contains('expanded')) {
                subLayers.classList.remove('expanded');
                expandBtn.textContent = '+';
            } else {
                subLayers.classList.add('expanded');
                expandBtn.textContent = '-';
            }
        }

        // Mobile menu toggle
        const hamburger = document.getElementById('hamburger');
        const navMenu = document.getElementById('navMenu');
        
        hamburger.addEventListener('click', () => {
            navMenu.classList.toggle('active');
        });

        // Three.js Setup
        let scene, camera, renderer;
        let solarSystem;
        let planets = {};
        let orbits = [];
        let starField;
        let sun;
        let mouseX = 0, mouseY = 0;
        let targetRotationX = 0, targetRotationY = 0;
        let isDragging = false;
        let isPanning = false;
        let cameraTarget = new THREE.Vector3(0, 0, 0);
        let cameraPan = new THREE.Vector3(0, 0, 0);
        
        let keys = {};
        let moveSpeed = 0.5;
        let verticalSpeed = 0.3;
        let canvasHasFocus = false;

        const planetData = {
            mercury: { 
                distance: 10, 
                size: 0.4, 
                color: 0x8c7853, 
                speed: 0.04, 
                name: 'Mercury',
                rotationSpeed: 0.005,
                orbitalInclination: 0.122, // 7 degrees in radians
                orbitalEccentricity: 0.4,
                moons: []
            },
            venus: { 
                distance: 15, 
                size: 0.9, 
                color: 0xffc649, 
                speed: 0.015, 
                name: 'Venus',
                rotationSpeed: -0.002,
                orbitalInclination: 0.059, // 3.4 degrees
                orbitalEccentricity: 0.15,
                moons: []
            },
            earth: { 
                distance: 20, 
                size: 1.0, 
                color: 0x4a90e2, 
                speed: 0.01, 
                name: 'Earth',
                rotationSpeed: 0.01,
                orbitalInclination: 0.0, // Reference plane
                orbitalEccentricity: 0.2,
                axialTilt: 0.41, // 23.5 degrees
                moons: [
                    { name: 'Moon', distance: 2, size: 0.27, color: 0xaaaaaa, speed: 0.05 }
                ]
            },
            mars: { 
                distance: 25, 
                size: 0.6, 
                color: 0xe27b58, 
                speed: 0.008, 
                name: 'Mars',
                rotationSpeed: 0.009,
                orbitalInclination: 0.032, // 1.85 degrees
                orbitalEccentricity: 0.35,
                moons: [
                    { name: 'Phobos', distance: 1.2, size: 0.08, color: 0x888888, speed: 0.08 },
                    { name: 'Deimos', distance: 1.8, size: 0.06, color: 0x999999, speed: 0.05 }
                ]
            },
            jupiter: { 
                distance: 35, 
                size: 2.5, 
                color: 0xc88b3a, 
                speed: 0.002, 
                name: 'Jupiter',
                rotationSpeed: 0.015,
                orbitalInclination: 0.023, // 1.3 degrees
                orbitalEccentricity: 0.25,
                moons: [
                    { name: 'Io', distance: 3.5, size: 0.3, color: 0xffff99, speed: 0.04 },
                    { name: 'Europa', distance: 4.2, size: 0.25, color: 0xcccccc, speed: 0.035 },
                    { name: 'Ganymede', distance: 5, size: 0.35, color: 0xaaaaaa, speed: 0.03 },
                    { name: 'Callisto', distance: 5.8, size: 0.32, color: 0x888888, speed: 0.025 }
                ]
            },
            saturn: { 
                distance: 45, 
                size: 2.0, 
                color: 0xfad5a5, 
                speed: 0.0009, 
                name: 'Saturn',
                rotationSpeed: 0.013,
                orbitalInclination: 0.043, // 2.5 degrees
                orbitalEccentricity: 0.3,
                hasRings: true,
                ringInner: 2.5,
                ringOuter: 4.0,
                ringColor: 0xc9b599,
                moons: [
                    { name: 'Titan', distance: 5, size: 0.4, color: 0xffa500, speed: 0.02 },
                    { name: 'Rhea', distance: 4, size: 0.15, color: 0xcccccc, speed: 0.025 },
                    { name: 'Iapetus', distance: 6, size: 0.12, color: 0x999999, speed: 0.015 }
                ]
            },
            uranus: { 
                distance: 55, 
                size: 1.5, 
                color: 0x4fd0e0, 
                speed: 0.0004, 
                name: 'Uranus',
                rotationSpeed: 0.008,
                orbitalInclination: 0.013, // 0.77 degrees
                orbitalEccentricity: 0.28,
                hasRings: true,
                ringInner: 1.8,
                ringOuter: 2.3,
                ringColor: 0x6fa8b8,
                ringTilt: Math.PI / 2.2,
                moons: [
                    { name: 'Titania', distance: 3, size: 0.2, color: 0xaaaaaa, speed: 0.025 },
                    { name: 'Oberon', distance: 3.5, size: 0.18, color: 0x999999, speed: 0.02 },
                    { name: 'Umbriel', distance: 2.5, size: 0.15, color: 0x888888, speed: 0.03 },
                    { name: 'Ariel', distance: 2, size: 0.14, color: 0xbbbbbb, speed: 0.035 }
                ]
            },
            neptune: { 
                distance: 65, 
                size: 1.4, 
                color: 0x4166f5, 
                speed: 0.0001, 
                name: 'Neptune',
                rotationSpeed: 0.009,
                orbitalInclination: 0.031, // 1.77 degrees
                orbitalEccentricity: 0.22,
                hasRings: true,
                ringInner: 1.7,
                ringOuter: 2.0,
                ringColor: 0x5577cc,
                moons: [
                    { name: 'Triton', distance: 3, size: 0.25, color: 0xccddff, speed: -0.03 },
                    { name: 'Proteus', distance: 2.2, size: 0.12, color: 0x999999, speed: 0.025 }
                ]
            }
        };

        function init() {
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x000000);

            const container = document.getElementById('container');

            camera = new THREE.PerspectiveCamera(
                50,
                container.clientWidth / container.clientHeight,
                1,
                1000
            );
            camera.position.set(0, 50, 100);
            camera.lookAt(cameraTarget);

            const canvas = document.getElementById('canvas');
            renderer = new THREE.WebGLRenderer({ canvas, antialias: true });
            renderer.setSize(container.clientWidth, container.clientHeight);
            renderer.setPixelRatio(window.devicePixelRatio);

            const ambientLight = new THREE.AmbientLight(0xffffff, 0.3);
            scene.add(ambientLight);

            const sunLight = new THREE.PointLight(0xffffff, 1.5, 300);
            sunLight.position.set(0, 0, 0);
            scene.add(sunLight);

            createSolarSystem();

            canvas.addEventListener('mouseenter', () => {
                canvasHasFocus = true;
            });
            
            canvas.addEventListener('mouseleave', () => {
                canvasHasFocus = false;
            });

            canvas.addEventListener('mousedown', (e) => {
                canvasHasFocus = true;
                onMouseDown(e);
            });

            canvas.addEventListener('mousemove', onMouseMove);
            canvas.addEventListener('mouseup', onMouseUp);
            canvas.addEventListener('wheel', onWheel);
            canvas.addEventListener('contextmenu', (e) => e.preventDefault());

            window.addEventListener('keydown', onKeyDown);
            window.addEventListener('keyup', onKeyUp);
            window.addEventListener('resize', onWindowResize);

            animate();
        }

        function createSolarSystem() {
            solarSystem = new THREE.Group();

            // Create realistic star field with varying sizes and colors
            const starGeometry = new THREE.BufferGeometry();
            const starVertices = [];
            const starColors = [];
            const starSizes = [];
            
            for (let i = 0; i < 8000; i++) {
                // Distribute stars in a spherical pattern
                const radius = 200 + Math.random() * 200;
                const theta = Math.random() * Math.PI * 2;
                const phi = Math.acos(2 * Math.random() - 1);
                
                const x = radius * Math.sin(phi) * Math.cos(theta);
                const y = radius * Math.sin(phi) * Math.sin(theta);
                const z = radius * Math.cos(phi);
                
                starVertices.push(x, y, z);
                
                // Star colors: white, blue-white, yellow-white, orange
                const colorType = Math.random();
                let r, g, b;
                if (colorType < 0.7) {
                    // White stars (most common)
                    r = g = b = 1;
                } else if (colorType < 0.85) {
                    // Blue-white stars
                    r = 0.7; g = 0.8; b = 1;
                } else if (colorType < 0.95) {
                    // Yellow-white stars
                    r = 1; g = 0.95; b = 0.8;
                } else {
                    // Orange-red stars
                    r = 1; g = 0.6; b = 0.4;
                }
                starColors.push(r, g, b);
                
                // Varying star sizes
                const size = Math.random() * 1.5 + 0.3;
                starSizes.push(size);
            }
            
            starGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starVertices, 3));
            starGeometry.setAttribute('color', new THREE.Float32BufferAttribute(starColors, 3));
            starGeometry.setAttribute('size', new THREE.Float32BufferAttribute(starSizes, 1));
            
            const starMaterial = new THREE.PointsMaterial({ 
                vertexColors: true,
                size: 0.8,
                sizeAttenuation: true,
                transparent: true,
                opacity: 0.9
            });
            starField = new THREE.Points(starGeometry, starMaterial);
            scene.add(starField);
            
            // Create Milky Way galaxy disk effect - Much larger and more visible
            const galaxyGeometry = new THREE.BufferGeometry();
            const galaxyVertices = [];
            const galaxyColors = [];
            
            for (let i = 0; i < 25000; i++) {
                // Create spiral galaxy pattern - much larger scale
                const angle = Math.random() * Math.PI * 2;
                const armOffset = (Math.floor(Math.random() * 4) * Math.PI / 2) + (Math.random() - 0.5) * 0.5;
                const distance = Math.pow(Math.random(), 0.5) * 600; // Much larger
                const spiralAngle = angle + armOffset + distance * 0.015;
                
                const x = Math.cos(spiralAngle) * distance;
                const z = Math.sin(spiralAngle) * distance;
                const y = (Math.random() - 0.5) * 40 * (1 - distance / 600); // Thinner at edges
                
                galaxyVertices.push(x, y, z);
                
                // Galaxy colors: bright yellow-white core, blue-white arms
                const distanceRatio = distance / 600;
                let r, g, b;
                if (distanceRatio < 0.2) {
                    // Very bright core
                    r = 1; g = 0.9; b = 0.7;
                } else if (distanceRatio < 0.5) {
                    // Inner arms
                    r = 0.9; g = 0.85; b = 0.8;
                } else {
                    // Outer arms with blue tint
                    r = 0.5 + Math.random() * 0.3;
                    g = 0.6 + Math.random() * 0.3;
                    b = 0.8 + Math.random() * 0.2;
                }
                galaxyColors.push(r, g, b);
            }
            
            galaxyGeometry.setAttribute('position', new THREE.Float32BufferAttribute(galaxyVertices, 3));
            galaxyGeometry.setAttribute('color', new THREE.Float32BufferAttribute(galaxyColors, 3));
            
            const galaxyMaterial = new THREE.PointsMaterial({
                vertexColors: true,
                size: 1.2, // Larger particles
                transparent: true,
                opacity: 0.6, // More visible
                sizeAttenuation: true,
                blending: THREE.AdditiveBlending // Glowing effect
            });
            
            const galaxyDisk = new THREE.Points(galaxyGeometry, galaxyMaterial);
            galaxyDisk.rotation.x = Math.PI / 2.5; // Tilt to see the disk
            galaxyDisk.position.set(0, -20, 0); // Centered better
            scene.add(galaxyDisk);
            solarSystem.userData.galaxyDisk = galaxyDisk;

            // Create Sun
            const sunGeometry = new THREE.SphereGeometry(3, 32, 32);
            const sunMaterial = new THREE.MeshBasicMaterial({ 
                color: 0xfdb813
            });
            sun = new THREE.Mesh(sunGeometry, sunMaterial);
            solarSystem.add(sun);

            // Add sun glow
            const glowGeometry = new THREE.SphereGeometry(3.5, 32, 32);
            const glowMaterial = new THREE.MeshBasicMaterial({
                color: 0xffa500,
                transparent: true,
                opacity: 0.3
            });
            const sunGlow = new THREE.Mesh(glowGeometry, glowMaterial);
            sun.add(sunGlow);

            // Create planets and orbits
            Object.keys(planetData).forEach(planetName => {
                const data = planetData[planetName];
                
                // Create elliptical orbit with inclination
                const orbitCurve = new THREE.EllipseCurve(
                    0, 0,
                    data.distance * (1 + data.orbitalEccentricity * 0.1), 
                    data.distance * (1 - data.orbitalEccentricity * 0.1),
                    0, 2 * Math.PI,
                    false,
                    0
                );
                
                const orbitPoints = orbitCurve.getPoints(128);
                const orbitGeometry = new THREE.BufferGeometry().setFromPoints(orbitPoints);
                const orbitMaterial = new THREE.LineBasicMaterial({ 
                    color: 0x444444,
                    transparent: true,
                    opacity: 0.4
                });
                const orbit = new THREE.Line(orbitGeometry, orbitMaterial);
                orbit.rotation.x = Math.PI / 2;
                orbit.rotation.y = data.orbitalInclination || 0;
                orbit.userData.planetName = planetName;
                orbits.push(orbit);
                solarSystem.add(orbit);

                // Create planet
                const planetGeometry = new THREE.SphereGeometry(data.size, 32, 32);
                const planetMaterial = new THREE.MeshPhongMaterial({ 
                    color: data.color,
                    shininess: 30
                });
                const planet = new THREE.Mesh(planetGeometry, planetMaterial);
                
                // Apply axial tilt if exists
                if (data.axialTilt) {
                    planet.rotation.z = data.axialTilt;
                }
                
                planet.position.x = data.distance;
                planet.userData.angle = Math.random() * Math.PI * 2;
                planet.userData.distance = data.distance;
                planet.userData.speed = data.speed;
                planet.userData.rotationSpeed = data.rotationSpeed;
                planet.userData.planetName = planetName;
                planet.userData.moons = [];
                planet.userData.orbitalEccentricity = data.orbitalEccentricity;
                planet.userData.orbitalInclination = data.orbitalInclination || 0;
                
                planets[planetName] = planet;
                solarSystem.add(planet);

                // Add rings if planet has them
                if (data.hasRings) {
                    const ringGeometry = new THREE.RingGeometry(data.size * data.ringInner / 2, data.size * data.ringOuter / 2, 64);
                    const ringMaterial = new THREE.MeshBasicMaterial({
                        color: data.ringColor,
                        side: THREE.DoubleSide,
                        transparent: true,
                        opacity: 0.7
                    });
                    const ring = new THREE.Mesh(ringGeometry, ringMaterial);
                    ring.rotation.x = data.ringTilt || Math.PI / 2.5;
                    planet.add(ring);
                    planet.userData.ring = ring;
                }

                // Add moons
                if (data.moons && data.moons.length > 0) {
                    data.moons.forEach(moonData => {
                        const moonGeometry = new THREE.SphereGeometry(moonData.size, 16, 16);
                        const moonMaterial = new THREE.MeshPhongMaterial({ color: moonData.color });
                        const moon = new THREE.Mesh(moonGeometry, moonMaterial);
                        moon.position.x = moonData.distance;
                        moon.userData.angle = Math.random() * Math.PI * 2;
                        moon.userData.distance = moonData.distance;
                        moon.userData.speed = moonData.speed;
                        moon.userData.name = moonData.name;
                        planet.add(moon);
                        planet.userData.moons.push(moon);
                    });
                }
            });

            // Create Asteroid Belt between Mars and Jupiter
            const asteroidBelt = new THREE.Group();
            const asteroidCount = 1200;
            const asteroidBeltInner = 28; // Between Mars (25) and Jupiter (35)
            const asteroidBeltOuter = 32;
            
            for (let i = 0; i < asteroidCount; i++) {
                const distance = asteroidBeltInner + Math.random() * (asteroidBeltOuter - asteroidBeltInner);
                const angle = Math.random() * Math.PI * 2;
                const size = 0.05 + Math.random() * 0.15;
                
                // Create irregular asteroid shape
                const asteroidGeometry = new THREE.SphereGeometry(size, 6, 6);
                // Randomize vertices for irregular shape
                const positions = asteroidGeometry.attributes.position.array;
                for (let j = 0; j < positions.length; j += 3) {
                    positions[j] *= (0.7 + Math.random() * 0.6);
                    positions[j + 1] *= (0.7 + Math.random() * 0.6);
                    positions[j + 2] *= (0.7 + Math.random() * 0.6);
                }
                asteroidGeometry.attributes.position.needsUpdate = true;
                
                const asteroidMaterial = new THREE.MeshPhongMaterial({ 
                    color: 0x666666 + Math.floor(Math.random() * 0x333333),
                    shininess: 5
                });
                const asteroid = new THREE.Mesh(asteroidGeometry, asteroidMaterial);
                
                asteroid.position.x = Math.cos(angle) * distance;
                asteroid.position.z = Math.sin(angle) * distance;
                asteroid.position.y = (Math.random() - 0.5) * 2; // Slight vertical variation
                
                asteroid.userData.angle = angle;
                asteroid.userData.distance = distance;
                asteroid.userData.speed = 0.005 + Math.random() * 0.003;
                asteroid.userData.rotationSpeed = {
                    x: (Math.random() - 0.5) * 0.02,
                    y: (Math.random() - 0.5) * 0.02,
                    z: (Math.random() - 0.5) * 0.02
                };
                
                asteroidBelt.add(asteroid);
            }
            solarSystem.add(asteroidBelt);
            solarSystem.userData.asteroidBelt = asteroidBelt;
            
            // Create Comets
            const comets = [];
            const cometCount = 5;
            
            for (let i = 0; i < cometCount; i++) {
                const cometGroup = new THREE.Group();
                
                // Comet nucleus
                const nucleusGeometry = new THREE.SphereGeometry(0.3, 16, 16);
                const nucleusMaterial = new THREE.MeshPhongMaterial({ 
                    color: 0xaaaaaa,
                    shininess: 20
                });
                const nucleus = new THREE.Mesh(nucleusGeometry, nucleusMaterial);
                cometGroup.add(nucleus);
                
                // Comet tail (elongated cone)
                const tailGeometry = new THREE.ConeGeometry(0.5, 8, 8);
                const tailMaterial = new THREE.MeshBasicMaterial({
                    color: 0x88ccff,
                    transparent: true,
                    opacity: 0.3,
                    side: THREE.DoubleSide
                });
                const tail = new THREE.Mesh(tailGeometry, tailMaterial);
                tail.rotation.x = Math.PI / 2;
                tail.position.z = -4;
                cometGroup.add(tail);
                
                // Comet coma (glow around nucleus)
                const comaGeometry = new THREE.SphereGeometry(1, 16, 16);
                const comaMaterial = new THREE.MeshBasicMaterial({
                    color: 0xaaddff,
                    transparent: true,
                    opacity: 0.15
                });
                const coma = new THREE.Mesh(comaGeometry, comaMaterial);
                cometGroup.add(coma);
                
                // Highly elliptical orbit
                const perihelion = 15 + Math.random() * 20; // Closest point to sun
                const aphelion = 70 + Math.random() * 50; // Farthest point from sun
                const orbitDistance = (perihelion + aphelion) / 2;
                const eccentricity = (aphelion - perihelion) / (aphelion + perihelion);
                
                cometGroup.userData.perihelion = perihelion;
                cometGroup.userData.aphelion = aphelion;
                cometGroup.userData.orbitDistance = orbitDistance;
                cometGroup.userData.eccentricity = eccentricity;
                cometGroup.userData.angle = Math.random() * Math.PI * 2;
                cometGroup.userData.speed = 0.005 + Math.random() * 0.005;
                cometGroup.userData.inclination = (Math.random() - 0.5) * 0.8; // High inclination
                cometGroup.userData.tail = tail;
                cometGroup.userData.nucleus = nucleus;
                
                // Random starting position
                const startAngle = Math.random() * Math.PI * 2;
                const startDistance = perihelion + Math.random() * (aphelion - perihelion);
                cometGroup.position.x = Math.cos(startAngle) * startDistance;
                cometGroup.position.z = Math.sin(startAngle) * startDistance;
                
                solarSystem.add(cometGroup);
                comets.push(cometGroup);
            }
            solarSystem.userData.comets = comets;

            scene.add(solarSystem);
        }

        function togglePlanet(planetName, visible) {
            if (planets[planetName]) {
                planets[planetName].visible = visible;
            }
        }

        function togglePlanetOrbit(planetName, visible) {
            orbits.forEach(orbit => {
                if (orbit.userData.planetName === planetName) {
                    orbit.visible = visible;
                }
            });
        }

        function toggleMoon(planetName, moonIndex, visible) {
            if (planets[planetName] && planets[planetName].userData.moons[moonIndex]) {
                planets[planetName].userData.moons[moonIndex].visible = visible;
            }
        }

        function toggleRings(planetName, visible) {
            if (planets[planetName] && planets[planetName].userData.ring) {
                planets[planetName].userData.ring.visible = visible;
            }
        }

        function togglePlanetGroup(group, visible) {
            const innerPlanets = ['mercury', 'venus', 'earth', 'mars'];
            const outerPlanets = ['jupiter', 'saturn', 'uranus', 'neptune'];
            const groupList = group === 'inner' ? innerPlanets : outerPlanets;
            
            groupList.forEach(planetName => {
                if (planets[planetName]) {
                    planets[planetName].visible = visible;
                }
            });
        }

        function toggleOrbits(visible) {
            orbits.forEach(orbit => {
                orbit.visible = visible;
            });
        }

        function toggleStars(visible) {
            if (starField) {
                starField.visible = visible;
            }
        }

        function toggleSun(visible) {
            if (sun) {
                sun.visible = visible;
            }
        }

        function toggleAsteroids(visible) {
            if (solarSystem.userData.asteroidBelt) {
                solarSystem.userData.asteroidBelt.visible = visible;
            }
        }

        function toggleComets(visible) {
            if (solarSystem.userData.comets) {
                solarSystem.userData.comets.forEach(comet => {
                    comet.visible = visible;
                });
            }
        }

        function toggleGalaxy(visible) {
            if (solarSystem.userData.galaxyDisk) {
                solarSystem.userData.galaxyDisk.visible = visible;
            }
        }

        function onMouseDown(e) {
            if (e.button === 0) {
                isDragging = true;
                isPanning = false;
            } else if (e.button === 2) {
                isPanning = true;
                isDragging = false;
            }
            mouseX = e.clientX;
            mouseY = e.clientY;
        }

        function onMouseMove(e) {
            if (isDragging) {
                const deltaX = e.clientX - mouseX;
                const deltaY = e.clientY - mouseY;
                
                targetRotationY += deltaX * 0.005;
                targetRotationX += deltaY * 0.005;
                
                mouseX = e.clientX;
                mouseY = e.clientY;
            } else if (isPanning) {
                const deltaX = e.clientX - mouseX;
                const deltaY = e.clientY - mouseY;
                
                const panSpeed = 0.1;
                
                const cameraDirection = new THREE.Vector3();
                camera.getWorldDirection(cameraDirection);
                
                const cameraRight = new THREE.Vector3();
                cameraRight.crossVectors(cameraDirection, new THREE.Vector3(0, 1, 0)).normalize();
                
                const cameraUp = new THREE.Vector3();
                cameraUp.crossVectors(cameraRight, cameraDirection).normalize();
                
                const panX = cameraRight.clone().multiplyScalar(-deltaX * panSpeed);
                const panY = cameraUp.clone().multiplyScalar(deltaY * panSpeed);
                
                camera.position.add(panX).add(panY);
                cameraTarget.add(panX).add(panY);
                cameraPan.copy(cameraTarget);
                
                mouseX = e.clientX;
                mouseY = e.clientY;
            }
        }

        function onMouseUp() {
            isDragging = false;
            isPanning = false;
        }

        function onWheel(e) {
            e.preventDefault();
            
            const rect = renderer.domElement.getBoundingClientRect();
            const mouse = new THREE.Vector2(
                ((e.clientX - rect.left) / rect.width) * 2 - 1,
                -((e.clientY - rect.top) / rect.height) * 2 + 1
            );
            
            const raycaster = new THREE.Raycaster();
            raycaster.setFromCamera(mouse, camera);
            
            const zoomDirection = raycaster.ray.direction.clone();
            const zoomAmount = e.deltaY > 0 ? 3 : -3;
            
            camera.position.addScaledVector(zoomDirection, zoomAmount);
            cameraTarget.addScaledVector(zoomDirection, zoomAmount);
            cameraPan.copy(cameraTarget);
            
            const distance = camera.position.length();
            if (distance < 10) {
                camera.position.normalize().multiplyScalar(10);
            }
        }

        function onKeyDown(e) {
            const navKeys = ['arrowup', 'arrowdown', 'arrowleft', 'arrowright', ' ', 'space'];
            const keyLower = e.key.toLowerCase();
            const codeLower = e.code.toLowerCase();
            
            if (canvasHasFocus && (navKeys.includes(keyLower) || navKeys.includes(codeLower))) {
                e.preventDefault();
                keys[keyLower] = true;
                keys[codeLower] = true;
            } else if (!navKeys.includes(keyLower) && !navKeys.includes(codeLower)) {
                keys[keyLower] = true;
                keys[codeLower] = true;
            }
        }

        function onKeyUp(e) {
            keys[e.key.toLowerCase()] = false;
            keys[e.code.toLowerCase()] = false;
        }

        function updateWalkMovement() {
            if (!canvasHasFocus) return;

            const forward = new THREE.Vector3();
            camera.getWorldDirection(forward);
            forward.y = 0;
            forward.normalize();

            const right = new THREE.Vector3();
            right.crossVectors(forward, new THREE.Vector3(0, 1, 0)).normalize();

            if (keys['w'] || keys['arrowup']) {
                camera.position.addScaledVector(forward, moveSpeed);
                cameraTarget.addScaledVector(forward, moveSpeed);
            }
            if (keys['s'] || keys['arrowdown']) {
                camera.position.addScaledVector(forward, -moveSpeed);
                cameraTarget.addScaledVector(forward, -moveSpeed);
            }

            if (keys['a'] || keys['arrowleft']) {
                camera.position.addScaledVector(right, -moveSpeed);
                cameraTarget.addScaledVector(right, -moveSpeed);
            }
            if (keys['d'] || keys['arrowright']) {
                camera.position.addScaledVector(right, moveSpeed);
                cameraTarget.addScaledVector(right, moveSpeed);
            }

            if (keys[' '] || keys['space']) {
                camera.position.y += verticalSpeed;
                cameraTarget.y += verticalSpeed;
            }
            if (keys['shift'] || keys['shiftleft'] || keys['shiftright']) {
                camera.position.y -= verticalSpeed;
                cameraTarget.y -= verticalSpeed;
            }

            cameraPan.copy(cameraTarget);
        }

        function onWindowResize() {
            const container = document.getElementById('container');
            camera.aspect = container.clientWidth / container.clientHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(container.clientWidth, container.clientHeight);
        }

        function animate() {
            requestAnimationFrame(animate);

            updateWalkMovement();

            // Rotate solar system
            solarSystem.rotation.y += (targetRotationY - solarSystem.rotation.y) * 0.1;
            solarSystem.rotation.x += (targetRotationX - solarSystem.rotation.x) * 0.1;

            // Animate planets orbiting
            Object.keys(planets).forEach(planetName => {
                const planet = planets[planetName];
                const data = planetData[planetName];
                
                planet.userData.angle += data.speed;
                
                // Calculate elliptical orbit with eccentricity
                const a = data.distance * (1 + data.orbitalEccentricity * 0.1); // Semi-major axis
                const b = data.distance * (1 - data.orbitalEccentricity * 0.1); // Semi-minor axis
                
                let x = a * Math.cos(planet.userData.angle);
                let z = b * Math.sin(planet.userData.angle);
                
                // Apply orbital inclination (tilt the orbit plane)
                const inclinationAngle = planet.userData.orbitalInclination;
                const y = z * Math.sin(inclinationAngle);
                z = z * Math.cos(inclinationAngle);
                
                planet.position.set(x, y, z);
                
                // Rotate planet on its axis
                planet.rotation.y += planet.userData.rotationSpeed;
                
                // Animate moons
                if (planet.userData.moons && planet.userData.moons.length > 0) {
                    planet.userData.moons.forEach(moon => {
                        moon.userData.angle += moon.userData.speed;
                        moon.position.x = Math.cos(moon.userData.angle) * moon.userData.distance;
                        moon.position.z = Math.sin(moon.userData.angle) * moon.userData.distance;
                        moon.rotation.y += 0.01;
                    });
                }
            });

            // Rotate sun
            if (sun) {
                sun.rotation.y += 0.005;
            }

            // Animate asteroid belt
            if (solarSystem.userData.asteroidBelt) {
                solarSystem.userData.asteroidBelt.children.forEach(asteroid => {
                    asteroid.userData.angle += asteroid.userData.speed;
                    asteroid.position.x = Math.cos(asteroid.userData.angle) * asteroid.userData.distance;
                    asteroid.position.z = Math.sin(asteroid.userData.angle) * asteroid.userData.distance;
                    
                    // Rotate asteroids
                    asteroid.rotation.x += asteroid.userData.rotationSpeed.x;
                    asteroid.rotation.y += asteroid.userData.rotationSpeed.y;
                    asteroid.rotation.z += asteroid.userData.rotationSpeed.z;
                });
            }

            // Animate comets
            if (solarSystem.userData.comets) {
                solarSystem.userData.comets.forEach(comet => {
                    comet.userData.angle += comet.userData.speed;
                    
                    // Calculate elliptical orbit
                    const a = comet.userData.aphelion;
                    const b = comet.userData.perihelion;
                    const angle = comet.userData.angle;
                    
                    let x = a * Math.cos(angle);
                    let z = b * Math.sin(angle);
                    
                    // Apply inclination
                    const inclinationAngle = comet.userData.inclination;
                    const y = z * Math.sin(inclinationAngle);
                    z = z * Math.cos(inclinationAngle);
                    
                    comet.position.set(x, y, z);
                    
                    // Point tail away from sun
                    const angleToSun = Math.atan2(-z, -x);
                    comet.rotation.y = angleToSun;
                    
                    // Scale tail based on distance from sun
                    const distanceFromSun = Math.sqrt(x * x + y * y + z * z);
                    const tailScale = Math.max(0.3, Math.min(1.5, 50 / distanceFromSun));
                    comet.userData.tail.scale.y = tailScale;
                    comet.userData.tail.material.opacity = Math.min(0.5, tailScale * 0.3);
                    
                    // Rotate nucleus
                    comet.userData.nucleus.rotation.x += 0.01;
                    comet.userData.nucleus.rotation.y += 0.015;
                });
            }

            // Slowly rotate star field
            if (starField) {
                starField.rotation.y += 0.00005;
                starField.rotation.x += 0.00002;
            }
            
            // Rotate galaxy disk
            if (solarSystem.userData.galaxyDisk) {
                solarSystem.userData.galaxyDisk.rotation.z += 0.0001;
            }

            cameraTarget.x = cameraPan.x;
            cameraTarget.z = cameraPan.z;
            
            camera.lookAt(cameraTarget);

            // Auto-rotate the entire system slowly
            solarSystem.rotation.y += 0.0005;

            renderer.render(scene, camera);
        }

        init();
    </script>
</body>
</html>
